\section{Hardware Thermal Management}

\subsection{Introduction}

\subsubsection*{Temperature Issue Arise}
\begin{itemize}
    \item 과거에는 성능 향상이 제일 중요한 과제였음
    \item 복잡한 미세공정, 높은 clock frequency, Chip area의 감소 $\Rightarrow$ Power Density 증가
    \item Power $\uparrow$ $\Rightarrow$ Power density(전력 밀도) $\uparrow$ $\Rightarrow$ $T$ $\uparrow$ $\Rightarrow$ $P_{\mathrm{leak}}$ $\uparrow$ $\Rightarrow$ Power $\uparrow$: Loop
    \item Multi-core architecture $\Rightarrow$ Thermal problem이 일시적으로 해소
\end{itemize}

\subsubsection*{Importance of Temperature Issue}
\begin{itemize}
    \item 공정미세화의 진행 $\Rightarrow$ 전력 밀도는 exponentially 상승 중 (원자로 수준에 근접)
    \item 신뢰도(reliability) 문제 초래: 수명, 영구적 손상 등
    \item Microprocessor Design Cost
    \begin{itemize}
        \item Core의 개수, 복잡도 등은 processor의 온도에 큰 영향을 미침
        \item 이러한 earliest design stages에서 온도에 관한 고려가 이루어져야 함
    \end{itemize}
    \item 온도는 매우 복잡한 과정으로 예측되며, 환경 요인에 영향을 많이 받음 $\Rightarrow$ 예측 어려움
    \begin{itemize}
        \item 주변 공기, 주변 chip, thermal grease의 종류 등에 영향 받음
    \end{itemize}
\end{itemize}

\subsubsection*{Temperature Management and Power Management}
\begin{itemize}
    \item 온도와 전력은 관계가 깊지만 전력의 절약이 항상 온도 감소를 가져오는 것은 아님
    \begin{itemize}
        \item 예: Memory Bank 도입하여 전력 소모 감소 $\Rightarrow$ 면적 감소로 전력 밀도 증가 $\Rightarrow$ 온도 증가
    \end{itemize}
    \item Power mgmt: 온도가 낮은(= underutilized) 영역에 집중, 변화 속도 빠름
    \item Temperature mgmt: 온도가 높은(= heavily utilized) 영역에 집중, 변화 속도 느림
    \item 두 management에 같은 techniques 사용 가능, But policies are different
\end{itemize}

\subsection{Temperature Monitoring}

\subsubsection*{Importance of Temperature Monitoring}
\begin{itemize}
    \item Chip의 온도는 매우 짧은 순간에 변함 $\Rightarrow$ 정확한 온도 monitoring X $\Rightarrow$ chip 손상 가능
    \item 효과적인 DTM(Dynamic Thermal Management)에 필수적인 요소임
    \item 대부분 CPU는 적어도 10개의 온도 센서를 가지고 있음 $\Rightarrow$ 센서의 데이터는 OS-level에서 읽을 수 있음
    \item Cool Down Techniques
    \begin{itemize}
        \item Thermal throttling: Operation stop, Clock ``literally'' stops. (HW scheme)
        \item DVFS: Power decreases (SW scheme)
    \end{itemize}
\end{itemize}
\pagebreak

\subsubsection*{Importance of On-chip Sensor Placement}
\begin{itemize}
    \item 열원과 센서간의 거리가 조금만 떨어져도 온도의 측정값은 불확실
    \item 열이 많이 발생할 것으로 예상되는 곳에 센서를 배치해야 함
    \item 너무 많은 센서를 배치하면 cost가 증가
    \begin{itemize}
        \item 센서의 면적(작음)보다는 analog-digital converter(큼)로 인해 주로 증가
        \item 최근에는 analog-digial converter를 share하여 사용하기도 함
    \end{itemize}
    \item 제한된 개수의 센서를 최적의 위치에 배치하는 것이 주요 과제
\end{itemize}

\subsubsection*{Techniques of On-chip Sensor Placement}
\begin{itemize}
    \item K-means clustering
    \begin{itemize}
        \item $k$ sensors (clusters) \& $n$ hotspots (data points) $\Rightarrow$ 각 $k$에 대해 optimal point를 찾아냄
    \end{itemize}
    \item Dynamic selection method
    \begin{itemize}
        \item Interpolation을 이용하여 열원 위치를 짐작함
        \item 통신량이 많음 $\Rightarrow$ serious interconnect power overhead
    \end{itemize}
\end{itemize}

\subsubsection*{Temperature Estimation}
\begin{itemize}
    \item Predictive (= Proactive): $T_{\mathrm{th}}$에 도달하기 전에 미리 thermal mgmt 수행
    \item Reactive: $T_{\mathrm{th}}$에 도달하면 thermal mgmt 수행
    \begin{itemize}
        \item 전력을 소모하고 온도가 올라갈 때까지 delay가 있음, Late response $\Rightarrow$ 비효율적!
    \end{itemize}
    \item Instruction의 operator에 따라 사용하는 CPU가 다름을 이용하여 prediction 수행
\end{itemize}

\subsection{(Micro)Architectural Techniques}

\subsubsection*{Dynamic Thermal Managment (DTM)}
\begin{itemize}
    \item 온도의 급격한 증가 (thermal excursion)을 monitoring하여 조절
    \item DVFS, Throttling (clock gating), Cooling solution등을 이용함
    \item Critical Temperature and Threshold Temperature
    \begin{itemize}
        \item $T_{\mathrm{threshold}}$: 넘지 않으면 좋으나 넘어도 큰 문제는 없는 온도. S/W(DVFS)가 manage
        \item $T_{\mathrm{critical}}$: 넘으면 심각한 문제가 발생할 수 있는 온도. H/W(throttling)가 manage
        \item $T_{\mathrm{critical}} > T_{\mathrm{threshold}}$
    \end{itemize}
    \item 최근 연구 주제: Costly throttling, 성능 저하 최소화
    \item DVFS나 Throttling을 통한 DTM은 필연적으로 delay 발생 (H/W: \textless 1$\mu$s, S/W: \textasciitilde 10ms)
    \figcmd{lower-power-computing/images/dtm-by-dvfs.PNG}{.5}
    \item 주로 frequency를 낮추어 DTM 수행. 100MHz 단위의 조절 가능 (전압은 낮아지는데 시간이 오래걸림)
\end{itemize}

\subsubsection*{Techniques for Microprocessor Cores/General Applications}
\begin{itemize}
    \item Feedback Control (Skadron et al. [2003])
    \begin{itemize}
        \item Application behavior을 토대로 전압과 frequency 조절 $\Rightarrow$ 성능 저하 최소화
        \item 대부분의 DTM techniques에 이용될 수 있음
    \end{itemize}
    \item DTM Considering Fan Speed (Shin et al. [2009])
    \begin{itemize}
        \item 전력 소모와 온도의 co-optimization이 필요
        \item 예: 온도를 낮추기 위해 cooling fan speed up
        \begin{itemize}
            \item 팬 사용으로 인해 추가 전력 발생
            \item 팬 사용으로 cool down되어 누설 전력 감소
        \end{itemize}
        \item 두 요소 같이 고려해야 함
    \end{itemize}
    \item Frequency Selection for Multi-core Microprocessor (Mukherjee and Memik [2006b])
    \begin{itemize}
        \item Core가 여러 개인 경우 코어 간에 열이 발산됨
        \item Core에 최적 frequency 사용, 이웃한 core의 사용을 피함
    \end{itemize}
    \item Adapt3D (Coskun et al. [2009]): Chip을 stack한 형태의 multi-core에 위의 technique 적용
\end{itemize}

\subsubsection*{Techniques for On-chip Caches}
\begin{itemize}
    \item Cache는 동적 전력이 낮아 온도가 낮음 / 누설 전력은 계속 증가함 $\Rightarrow$ Chip에서 높은 누설 전력 비중 차지
    \begin{itemize}
        \item \texttt{ld}, \texttt{sd}만 cache 사용 (\textless 20\%)
    \end{itemize}
    \item 유휴 상태 Power Reduction: Gated $V_{\mathrm{dd}}$, DVFS 등
    \item 하나의 cache line을 여러 row로 분산 $\Rightarrow$ 전력 밀도 $\downarrow$ (John et al. [2005])
    \item Selective cache ways + Gated $V_{\mathrm{dd}}$ (Ku et al. [2005])
    \item 원래 온도가 낮은 영역이기 때문에 비효율적임
\end{itemize}

